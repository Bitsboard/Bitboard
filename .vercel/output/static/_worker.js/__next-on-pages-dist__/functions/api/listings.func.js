var ye=Object.defineProperty;var Ee=Object.getOwnPropertyDescriptor;var Te=Object.getOwnPropertyNames;var Re=Object.prototype.hasOwnProperty;var ve=(p,h)=>()=>(p&&(h=p(p=0)),h);var _e=(p,h,G,E)=>{if(h&&typeof h=="object"||typeof h=="function")for(let T of Te(h))!Re.call(p,T)&&T!==G&&ye(p,T,{get:()=>h[T],enumerable:!(E=Ee(h,T))||E.enumerable});return p},se=(p,h,G)=>(_e(p,h,"default"),G&&_e(G,h,"default"));var be=p=>_e(ye({},"__esModule",{value:!0}),p);var z={};import*as zt from"async_hooks";var me=ve(()=>{se(z,zt)});import{__getNamedExports as Se}from"../../../__next-on-pages-dist__/webpack/7889.js";import{__getNamedExports as Ae}from"../../../__next-on-pages-dist__/webpack/1813.js";import{__getNamedExports as Oe}from"../../../__next-on-pages-dist__/webpack/65350c40fb927cd816847882c65007ef.js";import{__getNamedExports as we}from"../../../__next-on-pages-dist__/webpack/d146f456c84ad77aa2bdb7f4ffff385c.js";import{__getNamedExports as Ie}from"../../../__next-on-pages-dist__/webpack/0db62fc21f400f4ff93662ca787c3a50.js";import{__getNamedExports as Pe}from"../../../__next-on-pages-dist__/webpack/0406212c5b03d4d7d56d829c11dc80f8.js";import{__getNamedExports as $e}from"../../../__next-on-pages-dist__/manifest/27d10e462fba646daaa29468a0656e12.js";var d=globalThis.__nextOnPagesRoutesIsolation.getProxyFor("/api/listings"),Fe=Se(d,d,d),Ce=Fe.__chunk_7889,Le=Ae(d,d,d),Me=Le.__chunk_1813,fe=Oe(d,d,d),Ue=fe.__chunk_5492,Be=fe.__chunk_3059,xe=we(d,d,d),je=xe.__chunk_855,Ke=xe.__chunk_3808,_=Ie(d,d,d),De=_.__chunk_6195,He=_.__chunk_2067,qe=_.__chunk_1548,Xe=_.__chunk_2780,Ge=_.__chunk_5612,We=_.__chunk_9614,Ye=_.__chunk_3628,Ve=_.__chunk_5403,Je=_.__chunk_3,Qe=_.__chunk_9814,ze=_.__chunk_7114,Ze=_.__chunk_7894,et=_.__chunk_4414,tt=_.__chunk_9307,at=_.__chunk_74,nt=_.__chunk_7257,rt=_.__chunk_7398,_t=_.__chunk_6839,st=_.__chunk_5027,ot=_.__chunk_2738,it=_.__chunk_2113,ct=_.__chunk_2860,ut=_.__chunk_7460,pt=_.__chunk_8427,lt=_.__chunk_8997,dt=_.__chunk_8024,ht=_.__chunk_2403,gt=_.__chunk_8690,yt=_.__chunk_6087,mt=_.__chunk_6265,ft=_.__chunk_8610,xt=_.__chunk_7959,kt=_.__chunk_4303,Nt=_.__chunk_3326,Et=_.__chunk_391,Tt=_.__chunk_8789,Rt=_.__chunk_552,vt=_.__chunk_7649,bt=_.__chunk_2501,St=_.__chunk_6443,At=_.__chunk_2034,Ot=_.__chunk_3131,x=Pe(d,d,d),wt=x.__chunk_5524,It=x.__chunk_8536,Pt=x.__chunk_6765,$t=x.__chunk_9859,Ft=x.__chunk_4123,Ct=x.__chunk_3412,Lt=x.__chunk_8978,Mt=x.__chunk_1812,Ut=x.__chunk_1673,Bt=x.__chunk_5376,jt=x.__chunk_6617,Kt=x.__chunk_5767,Dt=x.__chunk_3109,Ht=x.__chunk_641,qt=x.__chunk_5514,Xt=x.__chunk_5257,Gt=x.__chunk_1616,Wt=x.__chunk_2328,oe=$e(d,d,d),Yt=oe.__NEXT_FONT_MANIFEST,Vt=oe.__REACT_LOADABLE_MANIFEST,Jt=oe.__BUILD_MANIFEST,sa=((p,h,G)=>(h._ENTRIES={},p.__BUILD_MANIFEST=Jt,p.__REACT_LOADABLE_MANIFEST=Vt,p.__NEXT_FONT_MANIFEST=Yt,p.__INTERCEPTION_ROUTE_REWRITE_MANIFEST="[]",p.__PRERENDER_MANIFEST='{"version":4,"routes":{"/careers":{"initialHeaders":{"x-next-cache-tags":"_N_T_/layout,_N_T_/careers/layout,_N_T_/careers/page,_N_T_/careers"},"experimentalBypassFor":[{"type":"header","key":"Next-Action"},{"type":"header","key":"content-type","value":"multipart/form-data;.*"}],"initialRevalidateSeconds":false,"srcRoute":"/careers","dataRoute":"/careers.rsc"},"/help":{"initialHeaders":{"x-next-cache-tags":"_N_T_/layout,_N_T_/help/layout,_N_T_/help/page,_N_T_/help"},"experimentalBypassFor":[{"type":"header","key":"Next-Action"},{"type":"header","key":"content-type","value":"multipart/form-data;.*"}],"initialRevalidateSeconds":false,"srcRoute":"/help","dataRoute":"/help.rsc"},"/":{"initialHeaders":{"x-next-cache-tags":"_N_T_/layout,_N_T_/page,_N_T_/"},"experimentalBypassFor":[{"type":"header","key":"Next-Action"},{"type":"header","key":"content-type","value":"multipart/form-data;.*"}],"initialRevalidateSeconds":false,"srcRoute":"/","dataRoute":"/index.rsc"},"/privacy":{"initialHeaders":{"x-next-cache-tags":"_N_T_/layout,_N_T_/privacy/layout,_N_T_/privacy/page,_N_T_/privacy"},"experimentalBypassFor":[{"type":"header","key":"Next-Action"},{"type":"header","key":"content-type","value":"multipart/form-data;.*"}],"initialRevalidateSeconds":false,"srcRoute":"/privacy","dataRoute":"/privacy.rsc"},"/about":{"initialHeaders":{"x-next-cache-tags":"_N_T_/layout,_N_T_/about/layout,_N_T_/about/page,_N_T_/about"},"experimentalBypassFor":[{"type":"header","key":"Next-Action"},{"type":"header","key":"content-type","value":"multipart/form-data;.*"}],"initialRevalidateSeconds":false,"srcRoute":"/about","dataRoute":"/about.rsc"},"/notifications":{"initialHeaders":{"x-next-cache-tags":"_N_T_/layout,_N_T_/notifications/layout,_N_T_/notifications/page,_N_T_/notifications"},"experimentalBypassFor":[{"type":"header","key":"Next-Action"},{"type":"header","key":"content-type","value":"multipart/form-data;.*"}],"initialRevalidateSeconds":false,"srcRoute":"/notifications","dataRoute":"/notifications.rsc"},"/safety":{"initialHeaders":{"x-next-cache-tags":"_N_T_/layout,_N_T_/safety/layout,_N_T_/safety/page,_N_T_/safety"},"experimentalBypassFor":[{"type":"header","key":"Next-Action"},{"type":"header","key":"content-type","value":"multipart/form-data;.*"}],"initialRevalidateSeconds":false,"srcRoute":"/safety","dataRoute":"/safety.rsc"},"/profile":{"initialHeaders":{"x-next-cache-tags":"_N_T_/layout,_N_T_/profile/layout,_N_T_/profile/page,_N_T_/profile"},"experimentalBypassFor":[{"type":"header","key":"Next-Action"},{"type":"header","key":"content-type","value":"multipart/form-data;.*"}],"initialRevalidateSeconds":false,"srcRoute":"/profile","dataRoute":"/profile.rsc"},"/support":{"initialHeaders":{"x-next-cache-tags":"_N_T_/layout,_N_T_/support/layout,_N_T_/support/page,_N_T_/support"},"experimentalBypassFor":[{"type":"header","key":"Next-Action"},{"type":"header","key":"content-type","value":"multipart/form-data;.*"}],"initialRevalidateSeconds":false,"srcRoute":"/support","dataRoute":"/support.rsc"},"/test-settings":{"initialHeaders":{"x-next-cache-tags":"_N_T_/layout,_N_T_/test-settings/layout,_N_T_/test-settings/page,_N_T_/test-settings"},"experimentalBypassFor":[{"type":"header","key":"Next-Action"},{"type":"header","key":"content-type","value":"multipart/form-data;.*"}],"initialRevalidateSeconds":false,"srcRoute":"/test-settings","dataRoute":"/test-settings.rsc"},"/terms":{"initialHeaders":{"x-next-cache-tags":"_N_T_/layout,_N_T_/terms/layout,_N_T_/terms/page,_N_T_/terms"},"experimentalBypassFor":[{"type":"header","key":"Next-Action"},{"type":"header","key":"content-type","value":"multipart/form-data;.*"}],"initialRevalidateSeconds":false,"srcRoute":"/terms","dataRoute":"/terms.rsc"},"/escrow":{"initialHeaders":{"x-next-cache-tags":"_N_T_/layout,_N_T_/escrow/layout,_N_T_/escrow/page,_N_T_/escrow"},"experimentalBypassFor":[{"type":"header","key":"Next-Action"},{"type":"header","key":"content-type","value":"multipart/form-data;.*"}],"initialRevalidateSeconds":false,"srcRoute":"/escrow","dataRoute":"/escrow.rsc"},"/faq":{"initialHeaders":{"x-next-cache-tags":"_N_T_/layout,_N_T_/faq/layout,_N_T_/faq/page,_N_T_/faq"},"experimentalBypassFor":[{"type":"header","key":"Next-Action"},{"type":"header","key":"content-type","value":"multipart/form-data;.*"}],"initialRevalidateSeconds":false,"srcRoute":"/faq","dataRoute":"/faq.rsc"},"/icon.svg":{"initialHeaders":{"cache-control":"public, immutable, no-transform, max-age=31536000","content-type":"image/svg+xml","x-next-cache-tags":"_N_T_/layout,_N_T_/icon.svg/layout,_N_T_/icon.svg/route,_N_T_/icon.svg"},"experimentalBypassFor":[{"type":"header","key":"Next-Action"},{"type":"header","key":"content-type","value":"multipart/form-data;.*"}],"initialRevalidateSeconds":false,"srcRoute":"/icon.svg","dataRoute":null},"/contact":{"initialHeaders":{"x-next-cache-tags":"_N_T_/layout,_N_T_/contact/layout,_N_T_/contact/page,_N_T_/contact"},"experimentalBypassFor":[{"type":"header","key":"Next-Action"},{"type":"header","key":"content-type","value":"multipart/form-data;.*"}],"initialRevalidateSeconds":false,"srcRoute":"/contact","dataRoute":"/contact.rsc"}},"dynamicRoutes":{},"notFoundRoutes":[],"preview":{"previewModeId":"process.env.__NEXT_PREVIEW_MODE_ID","previewModeSigningKey":"process.env.__NEXT_PREVIEW_MODE_SIGNING_KEY","previewModeEncryptionKey":"process.env.__NEXT_PREVIEW_MODE_ENCRYPTION_KEY"}}',(()=>{"use strict";var E={},T={};function t(a){var i=T[a];if(i!==void 0)return i.exports;var n=T[a]={exports:{}},g=!0;try{E[a](n,n.exports,t),g=!1}finally{g&&delete T[a]}return n.exports}t.m=E,t.amdO={},(()=>{var a=[];t.O=(i,n,g,y)=>{if(n){y=y||0;for(var l=a.length;l>0&&a[l-1][2]>y;l--)a[l]=a[l-1];a[l]=[n,g,y];return}for(var u=1/0,l=0;l<a.length;l++){for(var[n,g,y]=a[l],v=!0,w=0;w<n.length;w++)u>=y&&Object.keys(t.O).every(D=>t.O[D](n[w]))?n.splice(w--,1):(v=!1,y<u&&(u=y));if(v){a.splice(l--,1);var C=g();C!==void 0&&(i=C)}}return i}})(),t.n=a=>{var i=a&&a.__esModule?()=>a.default:()=>a;return t.d(i,{a:i}),i},(()=>{var a,i=Object.getPrototypeOf?n=>Object.getPrototypeOf(n):n=>n.__proto__;t.t=function(n,g){if(1&g&&(n=this(n)),8&g||typeof n=="object"&&n&&(4&g&&n.__esModule||16&g&&typeof n.then=="function"))return n;var y=Object.create(null);t.r(y);var l={};a=a||[null,i({}),i([]),i(i)];for(var u=2&g&&n;typeof u=="object"&&!~a.indexOf(u);u=i(u))Object.getOwnPropertyNames(u).forEach(v=>l[v]=()=>n[v]);return l.default=()=>n,t.d(y,l),y}})(),t.d=(a,i)=>{for(var n in i)t.o(i,n)&&!t.o(a,n)&&Object.defineProperty(a,n,{enumerable:!0,get:i[n]})},t.e=()=>Promise.resolve(),t.g=function(){if(typeof h=="object")return h;try{return this||Function("return this")()}catch{if(typeof window=="object")return window}}(),t.o=(a,i)=>Object.prototype.hasOwnProperty.call(a,i),t.r=a=>{typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(a,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(a,"__esModule",{value:!0})},(()=>{var a={993:0};t.O.j=g=>a[g]===0;var i=(g,y)=>{var l,u,[v,w,C]=y,L=0;if(v.some(j=>a[j]!==0)){for(l in w)t.o(w,l)&&(t.m[l]=w[l]);if(C)var W=C(t)}for(g&&g(y);L<v.length;L++)u=v[L],t.o(a,u)&&a[u]&&a[u][0](),a[u]=0;return t.O(W)},n=p.webpackChunk_N_E=p.webpackChunk_N_E||[];n.forEach(i.bind(null,0)),n.push=i.bind(null,n.push.bind(n))})()})(),(p.webpackChunk_N_E=p.webpackChunk_N_E||[]).push([[531],{3131:Ot,2034:At,6443:St,2501:bt,7649:vt,552:Rt,8789:Tt,391:Et,3326:Nt,4303:kt,7959:xt,8610:ft,6265:mt,6087:yt,8690:gt,2403:ht,8024:dt,8997:lt,8427:pt,7460:ut,2860:ct,2113:it,2738:ot,5027:st,6839:_t,7398:rt,7257:nt,74:at,9307:tt,4414:et,7894:Ze,7114:ze,9814:Qe,3:Je,5403:Ve,3628:Ye,9614:We,5612:Ge,2780:Xe,1548:qe}]),(p.webpackChunk_N_E=p.webpackChunk_N_E||[]).push([[703],{2328:Wt,1616:Gt,5257:Xt,5514:qt,641:Ht,3109:Dt,5767:Kt,6617:jt,5376:Bt,1673:Ut,1812:Mt,8978:Lt,3412:Ct,4123:Ft,9859:$t,6765:Pt,8536:It,5524:wt}]),(p.webpackChunk_N_E=p.webpackChunk_N_E||[]).push([[70,39],{2067:He,6195:De,5181:(E,T,t)=>{"use strict";t.r(T),t.d(T,{ComponentMod:()=>te,default:()=>ae});var a={};t.r(a),t.d(a,{GET:()=>w,POST:()=>C,runtime:()=>v});var i={};t.r(i),t.d(i,{originalPathname:()=>D,patchFetch:()=>ee,requestAsyncStorage:()=>W,routeModule:()=>L,serverHooks:()=>K,staticGenerationAsyncStorage:()=>j});var n=t(3109),g=t(5514),y=t(2860),l=t(2113);t(7889);var u=t(5492);let v="edge";async function w(H){try{let P,b=await Promise.resolve().then(t.t.bind(t,3808,23)).catch(()=>null);if(!b||typeof b.getRequestContext!="function")return u.xk.json({error:"adapter_missing"},{status:200});let k=b.getRequestContext().env.DB;if(!k)return u.xk.json({error:"no_db_binding"},{status:200});let f=new URL(H.url),c=Math.min(100,parseInt(f.searchParams.get("limit")??"50",10)||50),e=Math.max(0,parseInt(f.searchParams.get("offset")??"0",10)||0),o=(f.searchParams.get("q")||"").trim(),s=(f.searchParams.get("category")||"").trim(),r=(f.searchParams.get("adType")||"").trim().toLowerCase(),S=r==="sell"||r==="want"?r:"",m=f.searchParams.get("minPrice"),A=f.searchParams.get("maxPrice"),R=m!=null&&m!==""?Number(m):null,N=A!=null&&A!==""?Number(A):null,O=(f.searchParams.get("sortBy")||"date").trim(),q=(f.searchParams.get("sortOrder")||"desc").trim().toLowerCase(),M=Number(f.searchParams.get("lat")??""),B=Number(f.searchParams.get("lng")??""),Z=Number.isFinite(M)&&Number.isFinite(B),Y=f.searchParams.get("radiusKm"),V=Y!=null&&Y!==""?Number(Y):null,U=V===0?1e5:V,ne=U!=null&&Number.isFinite(U)&&U>=0;try{await k.prepare(`CREATE TABLE IF NOT EXISTS listings (
          id INTEGER PRIMARY KEY AUTOINCREMENT,
          title TEXT NOT NULL,
          price_sat INTEGER NOT NULL,
          created_at INTEGER NOT NULL DEFAULT (strftime('%s','now'))
        )`).run()}catch{}let $=[],I=[],X=[],J=[];if(o&&($.push("(title LIKE ? OR description LIKE ?)"),I.push(`%${o}%`,`%${o}%`),X.push("(title LIKE ?)"),J.push(`%${o}%`)),s&&s.toLowerCase()!=="featured"&&($.push("(category = ?)"),I.push(s)),S&&($.push("(ad_type = ?)"),I.push(S)),R!==null&&Number.isFinite(R)&&($.push("(price_sat >= ?)"),I.push(Math.round(R)),X.push("(price_sat >= ?)"),J.push(Math.round(R))),N!==null&&Number.isFinite(N)&&($.push("(price_sat <= ?)"),I.push(Math.round(N)),X.push("(price_sat <= ?)"),J.push(Math.round(N))),Z&&ne&&U<9e5){let F=U/111.32,Q=U/(111.32*Math.max(.01,Math.abs(Math.cos(M*Math.PI/180))));$.push("(lat BETWEEN ? AND ?)"),I.push(M-F,M+F),$.push("(lng BETWEEN ? AND ?)"),I.push(B-Q,B+Q)}let ie=$.length?`WHERE ${$.join(" AND ")}`:"",ce=X.length?`WHERE ${X.join(" AND ")}`:"",ue=O==="price"?"price_sat":"created_at",pe=q==="asc"?"ASC":"DESC",le=`ORDER BY ${ue} ${pe}`,de=[];O==="distance"&&Z&&(le="ORDER BY ((lat - ?)*(lat - ?)+(lng - ?)*(lng - ?)) ASC",de=[M,M,B,B]);let re=[];try{re=(await k.prepare(`SELECT id,
                         title,
                         description,
                         category,
                         ad_type AS adType,
                         location,
                         lat,
                         lng,
                         image_url AS imageUrl,
                         price_sat AS priceSat,
                         posted_by AS postedBy,
                         boosted_until AS boostedUntil,
                         created_at AS createdAt
                  FROM listings
                  ${ie}
                  ${le}
                  LIMIT ? OFFSET ?`).bind(...I,...de,c,e).all()).results??[]}catch{re=(await k.prepare(`SELECT id,
                         title,
                         price_sat AS priceSat,
                         created_at AS createdAt
                  FROM listings
                  ${ce}
                  ORDER BY ${ue} ${pe}
                  LIMIT ? OFFSET ?`).bind(...J,c,e).all()).results??[]}try{P=await k.prepare(`SELECT COUNT(*) AS c FROM listings ${ie}`).bind(...I).all()}catch{P=await k.prepare(`SELECT COUNT(*) AS c FROM listings ${ce}`).bind(...J).all()}let ke=P.results?.[0]?.c??0,he=["1518770660439-4636190af475","1542751371-adc38448a05e","1518779578993-ec3579fee39f","1512496015851-a90fb38ba796","1517816743773-6e0fd518b4a6","1517245386807-bb43f82c33c4","1541532713592-79a0317b6b77","1555617117-08d3a8fef16c"],ge=["demo_seller","satoshi","luna","rob","mika","arya","nova","kai"],Ne=re.map((F,Q)=>({...F,imageUrl:F.imageUrl&&F.imageUrl.trim()?F.imageUrl:`https://images.unsplash.com/photo-${he[Q%he.length]}?q=80&w=1600&auto=format&fit=crop`,postedBy:F.postedBy&&F.postedBy.trim()?F.postedBy:ge[Q%ge.length]}));return u.xk.json({listings:Ne,total:ke})}catch(P){let b=P?.message??"Internal Server Error";return u.xk.json({error:b,hint:"Ensure D1 binding 'DB' is set and schema exists"},{status:200})}}async function C(H){let P=await Promise.resolve().then(t.t.bind(t,3808,23)).catch(()=>null);if(!P||typeof P.getRequestContext!="function")return u.xk.json({error:"adapter_missing"},{status:200});let b=P.getRequestContext().env.DB;try{let k,f=null;try{let Y=H.headers.get("cookie")||"",V=/(?:^|; )session=([^;]+)/.exec(Y)?.[1]||"";if(V){let{getAuthSecret:U,verifyJwtHS256:ne}=await Promise.resolve().then(t.bind(t,1813)),$=await ne(V,U()),I=$?.email||"";I&&(await b.prepare(`CREATE TABLE IF NOT EXISTS users (
            id TEXT PRIMARY KEY,
            email TEXT UNIQUE,
            username TEXT UNIQUE,
            sso TEXT,
            verified INTEGER DEFAULT 0,
            is_admin INTEGER DEFAULT 0,
            banned INTEGER DEFAULT 0,
            created_at INTEGER NOT NULL,
            image TEXT
          )`).run(),f=(await b.prepare("SELECT id FROM users WHERE email = ?").bind(I).all()).results?.[0]?.id??null)}}catch{}try{await b.prepare("ALTER TABLE listings ADD COLUMN posted_by TEXT").run()}catch{}let c=await H.json(),e=(c?.title??"").toString().trim(),o=Number(c?.price_sat??c?.priceSat),s=(c?.description??"").toString(),r=(c?.category??"Misc").toString(),S=(c?.ad_type??c?.adType??"sell").toString(),m=(c?.location??"").toString(),A=Number(c?.lat??0),R=Number(c?.lng??0),N=(c?.image_url??c?.imageUrl??"").toString(),O=(c?.posted_by??c?.postedBy??"").toString()||f||"",q=c?.boosted_until??c?.boostedUntil;if(!e||!Number.isFinite(o)||o<0)return u.xk.json({error:"title (string) and price_sat (number) required"},{status:400});try{k=await b.prepare(`INSERT INTO listings (
          title, description, category, ad_type, location, lat, lng, image_url, price_sat, posted_by, boosted_until
        ) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)`).bind(e.slice(0,120),s,r,S,m,Number.isFinite(A)?A:0,Number.isFinite(R)?R:0,N,Math.round(o),O,q??null).run()}catch{k=await b.prepare("INSERT INTO listings (title, price_sat) VALUES (?, ?)").bind(e.slice(0,120),Math.round(o)).run()}let M=k.meta?.last_row_id??null,B=await b.prepare(`SELECT id,
                       title,
                       description,
                       category,
                       ad_type AS adType,
                       location,
                       lat,
                       lng,
                       image_url AS imageUrl,
                       price_sat AS priceSat,
                       posted_by AS postedBy,
                       boosted_until AS boostedUntil,
                       created_at AS createdAt
                FROM listings WHERE id = ?`).bind(M).all(),Z=B.results?.[0]??null;return u.xk.json({listing:Z,ok:!0})}catch{return u.xk.json({error:"invalid JSON body"},{status:400})}}let L=new g.AppRouteRouteModule({definition:{kind:y.x.APP_ROUTE,page:"/api/listings/route",pathname:"/api/listings",filename:"route",bundlePath:"app/api/listings/route"},resolvedPagePath:"/Users/georgedanayan/Bitboard/src/app/api/listings/route.ts",nextConfigOutput:"",userland:a}),{requestAsyncStorage:W,staticGenerationAsyncStorage:j,serverHooks:K}=L,D="/api/listings/route";function ee(){return(0,l.XH)({serverHooks:K,staticGenerationAsyncStorage:j})}let te=i,ae=n.a.wrap(L)},3808:Ke,855:je,3059:Be,5492:Ue,1813:Me,7889:Ce},E=>{var T=a=>E(E.s=a);E.O(0,[531,703],()=>T(5181));var t=E.O();(h._ENTRIES=typeof h._ENTRIES>"u"?{}:h._ENTRIES)["middleware_app/api/listings/route"]=t}]),function(){let E={exports:{},loaded:!1};return function(t,a){var i=Object.create,n=Object.defineProperty,g=Object.getOwnPropertyDescriptor,y=Object.getOwnPropertyNames,l=Object.getPrototypeOf,u=Object.prototype.hasOwnProperty,v=e=>n(e,"__esModule",{value:!0}),w=(e,o)=>{v(e);for(var s in o)n(e,s,{get:o[s],enumerable:!0})},C=(e,o,s)=>{if(o&&typeof o=="object"||typeof o=="function")for(let r of y(o))!u.call(e,r)&&r!=="default"&&n(e,r,{get:()=>o[r],enumerable:!(s=g(o,r))||s.enumerable});return e},L=e=>C(v(n(e!=null?i(l(e)):{},"default",e&&e.__esModule&&"default"in e?{get:()=>e.default,enumerable:!0}:{value:e,enumerable:!0})),e);w(a,{default:()=>b});var W=L((me(),be(z))),j="@next/request-context",K=Symbol.for(j),D=Symbol.for("internal.storage");function ee(){let e=h;if(!e[K]){let o=new W.AsyncLocalStorage,s={get:()=>o.getStore(),[D]:o};e[K]=s}return e[K]}var te=ee();function ae(e,o){return te[D].run(e,o)}function H(e){let o={};return e&&e.forEach((s,r)=>{o[r]=s,r.toLowerCase()==="set-cookie"&&(o[r]=P(s))}),o}function P(e){let o=[],s=0,r,S,m,A,R;function N(){for(;s<e.length&&/\s/.test(e.charAt(s));)s+=1;return s<e.length}function O(){return S=e.charAt(s),S!=="="&&S!==";"&&S!==","}for(;s<e.length;){for(r=s,R=!1;N();)if(S=e.charAt(s),S===","){for(m=s,s+=1,N(),A=s;s<e.length&&O();)s+=1;s<e.length&&e.charAt(s)==="="?(R=!0,s=A,o.push(e.substring(r,m)),r=s):s=m+1}else s+=1;(!R||s>=e.length)&&o.push(e.substring(r,e.length))}return o}function b(e){let o=e.staticRoutes.map(r=>({regexp:new RegExp(r.namedRegex),page:r.page})),s=e.dynamicRoutes?.map(r=>({regexp:new RegExp(r.namedRegex),page:r.page}))||[];return async function(r,S){let m=new URL(r.url).pathname,A={};if(e.nextConfig?.basePath&&m.startsWith(e.nextConfig.basePath)&&(m=m.replace(e.nextConfig.basePath,"")||"/"),e.nextConfig?.i18n)for(let N of e.nextConfig.i18n.locales){let O=new RegExp(`^/${N}($|/)`,"i");if(m.match(O)){m=m.replace(O,"/")||"/";break}}for(let N of o)if(N.regexp.exec(m)){A.name=N.page;break}if(!A.name){let N=f(m);for(let O of s||[]){if(N&&!f(O.page))continue;let q=O.regexp.exec(m);if(q){A={name:O.page,params:q.groups};break}}}let R=await ae({waitUntil:S.waitUntil},()=>h._ENTRIES[`middleware_${e.name}`].default.call({},{request:{url:r.url,method:r.method,headers:H(r.headers),ip:k(r.headers,c.Ip),geo:{city:k(r.headers,c.City,!0),country:k(r.headers,c.Country,!0),latitude:k(r.headers,c.Latitude),longitude:k(r.headers,c.Longitude),region:k(r.headers,c.Region,!0)},nextConfig:e.nextConfig,page:A,body:r.body}}));return R.waitUntil&&S.waitUntil(R.waitUntil),R.response}}function k(e,o,s=!1){let r=e.get(o)||void 0;return s&&r?decodeURIComponent(r):r}function f(e){return e==="/api"||e.startsWith("/api/")}var c;(function(e){e.City="x-vercel-ip-city",e.Country="x-vercel-ip-country",e.Ip="x-real-ip",e.Latitude="x-vercel-ip-latitude",e.Longitude="x-vercel-ip-longitude",e.Region="x-vercel-ip-country-region"})(c||(c={}))}(E,E.exports),E.exports}.call({}).default({name:"app/api/listings/route",staticRoutes:[{page:"/",regex:"^/(?:/)?$",routeKeys:{},namedRegex:"^/(?:/)?$"},{page:"/_not-found",regex:"^/_not\\-found(?:/)?$",routeKeys:{},namedRegex:"^/_not\\-found(?:/)?$"},{page:"/about",regex:"^/about(?:/)?$",routeKeys:{},namedRegex:"^/about(?:/)?$"},{page:"/admin",regex:"^/admin(?:/)?$",routeKeys:{},namedRegex:"^/admin(?:/)?$"},{page:"/careers",regex:"^/careers(?:/)?$",routeKeys:{},namedRegex:"^/careers(?:/)?$"},{page:"/contact",regex:"^/contact(?:/)?$",routeKeys:{},namedRegex:"^/contact(?:/)?$"},{page:"/escrow",regex:"^/escrow(?:/)?$",routeKeys:{},namedRegex:"^/escrow(?:/)?$"},{page:"/faq",regex:"^/faq(?:/)?$",routeKeys:{},namedRegex:"^/faq(?:/)?$"},{page:"/help",regex:"^/help(?:/)?$",routeKeys:{},namedRegex:"^/help(?:/)?$"},{page:"/icon.svg",regex:"^/icon\\.svg(?:/)?$",routeKeys:{},namedRegex:"^/icon\\.svg(?:/)?$"},{page:"/notifications",regex:"^/notifications(?:/)?$",routeKeys:{},namedRegex:"^/notifications(?:/)?$"},{page:"/privacy",regex:"^/privacy(?:/)?$",routeKeys:{},namedRegex:"^/privacy(?:/)?$"},{page:"/profile",regex:"^/profile(?:/)?$",routeKeys:{},namedRegex:"^/profile(?:/)?$"},{page:"/safety",regex:"^/safety(?:/)?$",routeKeys:{},namedRegex:"^/safety(?:/)?$"},{page:"/search",regex:"^/search(?:/)?$",routeKeys:{},namedRegex:"^/search(?:/)?$"},{page:"/support",regex:"^/support(?:/)?$",routeKeys:{},namedRegex:"^/support(?:/)?$"},{page:"/terms",regex:"^/terms(?:/)?$",routeKeys:{},namedRegex:"^/terms(?:/)?$"},{page:"/test-settings",regex:"^/test\\-settings(?:/)?$",routeKeys:{},namedRegex:"^/test\\-settings(?:/)?$"}],dynamicRoutes:[{page:"/api/listings/[id]",regex:"^/api/listings/([^/]+?)(?:/)?$",routeKeys:{nxtPid:"nxtPid"},namedRegex:"^/api/listings/(?<nxtPid>[^/]+?)(?:/)?$"},{page:"/api/users/[username]",regex:"^/api/users/([^/]+?)(?:/)?$",routeKeys:{nxtPusername:"nxtPusername"},namedRegex:"^/api/users/(?<nxtPusername>[^/]+?)(?:/)?$"},{page:"/api/users/[username]/listings",regex:"^/api/users/([^/]+?)/listings(?:/)?$",routeKeys:{nxtPusername:"nxtPusername"},namedRegex:"^/api/users/(?<nxtPusername>[^/]+?)/listings(?:/)?$"},{page:"/en/[username]",regex:"^/en/([^/]+?)(?:/)?$",routeKeys:{nxtPusername:"nxtPusername"},namedRegex:"^/en/(?<nxtPusername>[^/]+?)(?:/)?$"}],nextConfig:{basePath:"",i18n:{locales:["en","fr","es","de"],defaultLocale:"en"}}})))(d,d,d);export{sa as default};

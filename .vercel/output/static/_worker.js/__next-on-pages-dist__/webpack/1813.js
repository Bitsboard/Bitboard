var g={},v=(H,_,b)=>(g.__chunk_1813=(C,y,d)=>{"use strict";function a(e){let t;typeof e=="string"?t=new TextEncoder().encode(e):e instanceof Uint8Array?t=e:t=new Uint8Array(e);let r="";for(let n=0;n<t.length;n++)r+=String.fromCharCode(t[n]);return btoa(r).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/g,"")}function u(e){let t=e.length%4==0?"":"=".repeat(4-e.length%4),r=atob(e.replace(/-/g,"+").replace(/_/g,"/")+t),n=new Uint8Array(r.length);for(let i=0;i<r.length;i++)n[i]=r.charCodeAt(i);return n}async function s(e){return crypto.subtle.importKey("raw",new TextEncoder().encode(e),{name:"HMAC",hash:"SHA-256"},!1,["sign","verify"])}async function h(e,t){let r=a(JSON.stringify({alg:"HS256",typ:"JWT"})),n=a(JSON.stringify(e)),i=`${r}.${n}`,c=await s(t),o=a(await crypto.subtle.sign("HMAC",c,new TextEncoder().encode(i)));return`${i}.${o}`}async function f(e,t){let r=e.split(".");if(r.length!==3)return null;let[n,i,c]=r,o=`${n}.${i}`,E=await s(t),$=u(c);if(!await crypto.subtle.verify("HMAC",E,$.buffer,new TextEncoder().encode(o)))return null;try{let l=JSON.parse(new TextDecoder().decode(u(i)));return typeof l.exp=="number"&&1e3*l.exp<Date.now()?null:l}catch{return null}}function p(){let e=process.env.NEXTAUTH_SECRET||process.env.AUTH_SECRET||"";if(!e)throw Error("Missing auth secret (NEXTAUTH_SECRET or AUTH_SECRET)");return e}function A(e,t,r={}){let n=[`${e}=${t}`,`Path=${r.path??"/"}`,"SameSite=Lax","Secure"];return r.httpOnly!==!1&&n.push("HttpOnly"),r.maxAgeSec&&n.push(`Max-Age=${r.maxAgeSec}`),n.join("; ")}function w(e){return`${e}=; Path=/; Expires=Thu, 01 Jan 1970 00:00:00 GMT; SameSite=Lax; Secure; HttpOnly`}async function S(e){let t=new TextEncoder().encode(e);return a(await crypto.subtle.digest("SHA-256",t))}function m(e=32){let t=new Uint8Array(e);return crypto.getRandomValues(t),a(t)}function T(){let e=new Uint8Array(16);crypto.getRandomValues(e),e[6]=15&e[6]|64,e[8]=63&e[8]|128;let t=Array.from(e).map(r=>r.toString(16).padStart(2,"0")).join("");return`${t.slice(0,8)}-${t.slice(8,12)}-${t.slice(12,16)}-${t.slice(16,20)}-${t.slice(20)}`}async function x(e){try{let t=e.headers.get("cookie")||"",r=/(?:^|; )session=([^;]+)/.exec(t)?.[1];if(!r)return null;let n=await f(r,p());return n?{user:{id:n.sub,email:n.email||"",username:n.username,image:n.picture,verified:n.verified||!1,isAdmin:n.isAdmin||!1},account:{sso:n.sso||"unknown",verified:n.verified||!1,registeredAt:Math.floor(Date.now()/1e3)},expires:n.exp}:null}catch{return null}}d.d(y,{AX:()=>m,getAuthSecret:()=>p,k$:()=>T,kT:()=>w,pC:()=>A,v6:()=>x,verifyJwtHS256:()=>f,yC:()=>S,yw:()=>h})},g);export{v as __getNamedExports};

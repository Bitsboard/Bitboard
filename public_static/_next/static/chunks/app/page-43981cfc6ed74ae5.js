(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{2769:function(e,t,a){Promise.resolve().then(a.bind(a,3009))},6463:function(e,t,a){"use strict";var l=a(1169);a.o(l,"useParams")&&a.d(t,{useParams:function(){return l.useParams}}),a.o(l,"useRouter")&&a.d(t,{useRouter:function(){return l.useRouter}}),a.o(l,"useSearchParams")&&a.d(t,{useSearchParams:function(){return l.useSearchParams}})},3009:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return g}});var l=a(7437),s=a(2265),r=a(8969),n=a(8011),i=a(9354);let o=[{id:"user1",email:"satoshi@example.com",handle:"satoshi",image:"https://images.unsplash.com/photo-1494790108755-2616b612b786?w=150&h=150&fit=crop&crop=face",rating:4.8,deals:12},{id:"user2",email:"luna@example.com",handle:"luna",image:"https://images.unsplash.com/photo-1507003211169-0a1dd7228f2d?w=150&h=150&fit=crop&crop=face",rating:4.9,deals:8},{id:"user3",email:"rob@example.com",handle:"rob",image:"https://images.unsplash.com/photo-1438761681033-6461ffad8d80?w=150&h=150&fit=crop&crop=face",rating:4.7,deals:15},{id:"user4",email:"mika@example.com",handle:"mika",image:"https://images.unsplash.com/photo-1494790108755-2616b612b786?w=150&h=150&fit=crop&crop=face",rating:4.6,deals:9},{id:"user5",email:"arya@example.com",handle:"arya",image:"https://images.unsplash.com/photo-1507003211169-0a1dd7228f2d?w=150&h=150&fit=crop&crop=face",rating:4.5,deals:6},{id:"user6",email:"nova@example.com",handle:"nova",image:"https://images.unsplash.com/photo-1438761681033-6461ffad8d80?w=150&h=150&fit=crop&crop=face",rating:4.4,deals:11},{id:"user7",email:"kai@example.com",handle:"kai",image:"https://images.unsplash.com/photo-1494790108755-2616b612b786?w=150&h=150&fit=crop&crop=face",rating:4.3,deals:7},{id:"user8",email:"zen@example.com",handle:"zen",image:"https://images.unsplash.com/photo-1507003211169-0a1dd7228f2d?w=150&h=150&fit=crop&crop=face",rating:4.2,deals:13},{id:"user9",email:"olivia@example.com",handle:"olivia",image:"https://images.unsplash.com/photo-1438761681033-6461ffad8d80?w=150&h=150&fit=crop&crop=face",rating:4.1,deals:5},{id:"user10",email:"noah@example.com",handle:"noah",image:"https://images.unsplash.com/photo-1494790108755-2616b612b786?w=150&h=150&fit=crop&crop=face",rating:4,deals:8}];"Lorem ipsum dolor sit amet, consectetur adipiscing elit. ".repeat(60),Date.now(),Date.now(),o[0].handle,o[0].deals,o[0].rating,"Lorem ipsum dolor sit amet, consectetur adipiscing elit. ".repeat(60),Date.now(),o[1].handle,o[1].deals,o[1].rating,"Lorem ipsum dolor sit amet, consectetur adipiscing elit. ".repeat(60),Date.now(),o[2].handle,o[2].deals,o[2].rating,"Lorem ipsum dolor sit amet, consectetur adipiscing elit. ".repeat(60),Date.now(),o[0].handle,o[0].deals,o[0].rating,"Lorem ipsum dolor sit amet, consectetur adipiscing elit. ".repeat(60),Date.now(),o[1].handle,o[1].deals,o[1].rating,"Lorem ipsum dolor sit amet, consectetur adipiscing elit. ".repeat(60),Date.now(),o[2].handle,o[2].deals,o[2].rating,Date.now(),Date.now();var c=a(6463),d=a(6248),m=a(6062),u=a(8070);function g(){let{theme:e,unit:t,layout:a}=(0,u.rV)(),o="dark"===e,[g,p]=(0,s.useState)(null),[h,x]=(0,s.useState)([]),[f,b]=(0,s.useState)(null),[w,v]=(0,s.useState)(null),[N,y]=(0,s.useState)(!1),[j,S]=(0,s.useState)(!1),[k,_]=(0,s.useState)(""),[C,L]=(0,s.useState)("Featured"),[D,F]=(0,s.useState)({name:"Toronto (City Center)",lat:43.653,lng:-79.383}),[E,R]=(0,s.useState)(25),[U,P]=(0,s.useState)(!1),[I,O]=(0,s.useState)("all"),[K,A]=(0,s.useState)(null),[M,T]=(0,s.useState)(0),q=(0,s.useRef)(!1),[B,J]=(0,s.useState)(!0),[z,V]=(0,s.useState)(!1),H=(0,s.useRef)(null),Q=(0,c.useRouter)(),$=(0,m.J)();(0,s.useEffect)(()=>{try{let e=localStorage.getItem("userLocation");if(e){let t=JSON.parse(e);t&&"number"==typeof t.lat&&"number"==typeof t.lng&&t.name&&F(t)}let t=localStorage.getItem("userRadiusKm");if(t){let e=Number(t);Number.isFinite(e)&&e>0&&R(e)}}catch(e){}},[]),(0,s.useEffect)(()=>{try{"1"===localStorage.getItem("usingMyLocation")&&F(e=>({...e,name:(0,d.t)("my_location",$)}));let e=Number(localStorage.getItem("userRadiusKm")||"");Number.isFinite(e)&&R(e)}catch(e){}},[$]),(0,s.useEffect)(()=>{fetch("/api/rate").then(e=>e.json()).then(e=>A(e.cad)).catch(()=>{})},[]);let G=(0,s.useCallback)(e=>e.map(e=>{var t,a;return{id:String(e.id),title:e.title,desc:(null!==(t=e.description)&&void 0!==t?t:"")+"\n\n"+"Lorem ipsum dolor sit amet, consectetur adipiscing elit. ".repeat(40),priceSats:Number(e.priceSat)||0,category:e.category||"Electronics",location:(e.location||"").replace(/\s*[â€¢|\-].*$/,"").replace(/\(.*?\)/g,"").trim().replace(/\s{2,}/g," ").replace(/,\s*,/g,", ").replace(/\s+,\s+/g,", ")||"Toronto, ON",lat:Number.isFinite(e.lat)?e.lat:43.6532,lng:Number.isFinite(e.lng)?e.lng:-79.3832,type:"want"===e.adType?"want":"sell",images:Array.isArray(e.imageUrl)&&e.imageUrl.length>0?e.imageUrl:"string"==typeof e.imageUrl&&e.imageUrl.includes(",")?e.imageUrl.split(",").map(e=>e.trim()).filter(Boolean):[..."string"==typeof e.imageUrl&&e.imageUrl?[e.imageUrl]:[],"https://images.unsplash.com/photo-1555617117-08d3a8fef16c?w=1200&q=80&auto=format&fit=crop","https://images.unsplash.com/photo-1518779578993-ec3579fee39f?w=1200&q=80&auto=format&fit=crop","https://images.unsplash.com/photo-1517336714731-489689fd1ca8?w=1200&q=80&auto=format&fit=crop"].slice(0,5),boostedUntil:null!==(a=e.boostedUntil)&&void 0!==a?a:null,seller:(()=>{let t=(e.postedBy||"demo_seller").replace(/^@/,""),a=Number(e.id)%100,l=5+a%80,s=l>=50;return{name:t,score:l,deals:a%40,rating:4+a%10/10,verifications:{email:!0,phone:s,lnurl:s},onTimeRelease:s?.97:.9}})(),createdAt:1e3*Number(e.createdAt)}}),[]);(0,s.useEffect)(()=>{(async()=>{try{var e,t;q.current=!0;let a=new URLSearchParams({limit:String(24),offset:"0"});Number.isFinite(D.lat)&&Number.isFinite(D.lng)&&(a.set("lat",String(D.lat)),a.set("lng",String(D.lng))),Number.isFinite(E)&&a.set("radiusKm",String(E));let l=await fetch("/api/listings?".concat(a.toString())),s=await l.json(),r=null!==(e=s.listings)&&void 0!==e?e:[],n=G(r);x(n);let i=Number(null!==(t=s.total)&&void 0!==t?t:0);T(i),J(n.length<i)}catch(e){}finally{q.current=!1}})()},[!0,D.lat,D.lng,E]);let W=(0,s.useCallback)(async()=>{if(!q.current&&B)try{var e,t;q.current=!0,V(!0);let a=h.length,l=new URLSearchParams({limit:String(24),offset:String(a)});Number.isFinite(D.lat)&&Number.isFinite(D.lng)&&(l.set("lat",String(D.lat)),l.set("lng",String(D.lng))),Number.isFinite(E)&&l.set("radiusKm",String(E));let s=await fetch("/api/listings?".concat(l.toString())),r=await s.json(),n=null!==(e=r.listings)&&void 0!==e?e:[],i=G(n);x(e=>[...e,...i]);let o=Number(null!==(t=r.total)&&void 0!==t?t:M);T(o),J(e=>e&&a+i.length<o)}catch(e){}finally{q.current=!1,V(!1)}},[!0,B,h.length,G,24,M,D.lat,D.lng,E]);(0,s.useEffect)(()=>{let e=H.current;if(!e)return;let t=new IntersectionObserver(e=>{for(let t of e)if(t.isIntersecting){W();break}},{rootMargin:"1000px 0px"});return t.observe(e),()=>t.disconnect()},[!0,W]),(0,s.useEffect)(()=>{let e=e=>{"Escape"===e.key&&(b(null),v(null),y(!1),S(!1))};return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)},[]);let X=(0,s.useMemo)(()=>{let e=h;return k&&(e=e.filter(e=>e.title.toLowerCase().includes(k.toLowerCase())||e.desc.toLowerCase().includes(k.toLowerCase())||e.category.toLowerCase().includes(k.toLowerCase()))),"all"!==I&&(e=e.filter(e=>e.type===I)),e},[h,k,I]),Y=(0,s.useMemo)(()=>"Featured"===C?X.filter(e=>"Services"!==e.category):"Services"===C?[]:X.filter(e=>e.category===C),[X,C]);(0,s.useMemo)(()=>"Featured"===C?X.filter(e=>"Services"===e.category):"Services"===C?X.filter(e=>"Services"===e.category):[],[X,C]);let Z=(0,s.useMemo)(()=>h.filter(e=>"Services"!==e.category).slice(0,12),[h]),ee=e=>{g?e():S(!0)},et=o?"bg-gradient-to-br from-neutral-950 via-neutral-900 to-neutral-950":"bg-gradient-to-br from-neutral-50 via-white to-neutral-100",ea=o?"border border-white/30 bg-neutral-800/50 text-neutral-100 placeholder-neutral-400 backdrop-blur-sm":"border border-neutral-700/30 bg-white/80 text-neutral-900 placeholder-neutral-500 backdrop-blur-sm",el=(0,s.useCallback)(()=>{let e=new URLSearchParams;k&&e.set("q",k),C&&"Featured"!==C&&e.set("category",C),I&&"all"!==I&&e.set("adType",I);try{localStorage.setItem("layoutPref",a)}catch(e){}e.set("layout",a);let t=window.location.pathname.split("/").filter(Boolean)[0],l=t&&["en","fr","es","de"].includes(t)?t:$;Q.push("".concat("/".concat(l),"/search?").concat(e.toString()))},[I,C,k,a,Q,$]);return(0,l.jsxs)("div",{className:(0,i.cn)("min-h-screen",et,o?"dark":""),children:[(0,l.jsxs)("header",{className:"relative overflow-hidden",children:[(0,l.jsxs)("div",{className:"absolute inset-0",children:[(0,l.jsx)("div",{className:(0,i.cn)("absolute inset-0 blur-3xl opacity-30",o?"bg-gradient-to-br from-orange-500/20 via-amber-500/10 to-transparent":"bg-gradient-to-br from-orange-300/30 via-amber-200/20 to-transparent")}),(0,l.jsx)("div",{className:"absolute inset-0 bg-[radial-gradient(circle_at_50%_50%,rgba(120,119,198,0.1),transparent_50%)]"})]}),(0,l.jsx)("div",{className:"relative mx-auto max-w-7xl px-4 py-8 sm:py-10",children:(0,l.jsxs)("div",{className:"flex flex-col-reverse items-start gap-3 md:flex-row md:items-center md:justify-between",children:[(0,l.jsxs)("div",{className:"max-w-2xl",children:[(0,l.jsxs)("h1",{className:"text-5xl font-black tracking-tight sm:text-7xl",children:[(0,l.jsxs)("span",{className:(0,i.cn)("en"===$?"block":"inline","leading-tight",o?"text-white":"text-black"),children:[(0,d.t)("title_hero_1",$),"en"!==$?" ":""]}),(0,l.jsx)("span",{className:(0,i.cn)("en"===$?"block":"inline","bg-gradient-to-r from-amber-400 via-orange-500 to-red-500 bg-clip-text text-transparent"),style:{lineHeight:"1.2"},children:(0,d.t)("title_hero_2",$)})]}),(0,l.jsx)("p",{className:(0,i.cn)("mt-6 text-xl leading-relaxed",o?"text-neutral-300":"text-neutral-600"),children:(0,d.t)("subheading",$)})]}),(0,l.jsxs)("div",{className:"w-full md:w-[460px] md:self-center",children:[(0,l.jsx)("div",{className:"mb-2 md:mb-1 flex md:justify-end",children:(0,l.jsx)("button",{onClick:()=>P(!0),className:(0,i.cn)("w-full md:w-[calc(100%-120px)] rounded-3xl px-6 py-5 text-left focus:outline-none",ea),children:(0,l.jsxs)("div",{className:"flex items-center justify-between gap-3",children:[(0,l.jsx)("div",{className:(0,i.cn)("truncate",o?"text-neutral-100":"text-neutral-900"),children:0===E?(0,d.t)("all_listings_globally",$):(null==D?void 0:D.name)||(0,d.t)("choose_location",$)}),(0,l.jsx)("div",{className:(0,i.cn)("text-sm whitespace-nowrap shrink-0",o?"text-neutral-300":"text-neutral-700"),children:0===E?(0,d.t)("change",$):"".concat(E," km")})]})})}),(0,l.jsxs)("div",{className:"relative mt-2",children:[(0,l.jsx)("input",{value:k,onChange:e=>_(e.target.value),onKeyDown:e=>{"Enter"===e.key&&el()},placeholder:(0,d.t)("search_placeholder",$),className:(0,i.cn)("w-full rounded-3xl px-6 pr-32 py-5 text-lg focus:outline-none transition-all duration-300",ea)}),(0,l.jsx)("button",{onClick:el,className:"absolute right-3 top-1/2 -translate-y-1/2 rounded-2xl bg-gradient-to-r from-orange-500 to-red-500 px-5 py-2 text-sm font-semibold text-white shadow",children:(0,d.t)("search",$)})]})]})]})})]}),(0,l.jsxs)("main",{id:"browse",className:"mx-auto max-w-7xl px-4 pb-24",children:[Z.length>0&&(0,l.jsxs)("section",{className:"mt-6",children:[(0,l.jsx)("div",{className:"mb-6 flex items-baseline justify-between",children:(0,l.jsx)("div",{className:"flex items-center gap-3",children:(0,l.jsx)("h2",{className:(0,i.cn)("text-3xl font-bold",o?"text-white":"text-neutral-900"),children:(0,d.t)("featured",$)})})}),(0,l.jsx)(n.ItemsCarousel,{listings:Z,unit:t,btcCad:K,dark:o,onOpen:e=>b(e)})]}),(0,l.jsxs)("section",{className:"mt-16",children:[(0,l.jsx)("div",{className:"mb-6 flex items-baseline justify-between",children:(0,l.jsxs)("div",{className:"flex items-center gap-4",children:[(0,l.jsx)("h2",{className:(0,i.cn)("text-3xl font-bold flex items-center gap-3",o?"text-white":"text-neutral-900"),children:(0,d.t)("latest",$)}),(0,l.jsxs)("span",{className:(0,i.cn)("text-sm font-medium",o?"text-neutral-400":"text-neutral-500"),children:[Y.length," ",(0,d.t)("results",$)]})]})}),"grid"===a?(0,l.jsxs)("div",{className:"grid grid-cols-1 gap-8 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4",children:[Y.map(e=>(0,l.jsx)(r.dF,{listing:e,unit:t,btcCad:K,dark:o,onOpen:()=>b(e)},e.id)),0===Y.length&&(0,l.jsxs)("div",{className:(0,i.cn)("col-span-full rounded-3xl p-16 text-center border-2 border-dashed",o?"border-neutral-700 text-neutral-400":"border-neutral-300 text-neutral-500"),children:[(0,l.jsx)("div",{className:"text-4xl mb-4",children:"\uD83D\uDD0D"}),(0,l.jsx)("p",{className:(0,i.cn)("text-lg font-medium",o?"text-neutral-300":"text-neutral-700"),children:(0,d.t)("no_goods_match",$)}),(0,l.jsx)("p",{className:(0,i.cn)("text-sm mt-2",o?"text-neutral-400":"text-neutral-600"),children:(0,d.t)("try_widen_radius",$)})]})]}):(0,l.jsxs)("div",{className:"space-y-4 max-w-5xl mx-auto w-full",children:[Y.map(e=>(0,l.jsx)(r.tE,{listing:e,unit:t,btcCad:K,dark:o,onOpen:()=>b(e)},e.id)),0===Y.length&&(0,l.jsxs)("div",{className:(0,i.cn)("rounded-3xl p-16 text-center border-2 border-dashed",o?"border-neutral-700 text-neutral-400":"border-neutral-300 text-neutral-500"),children:[(0,l.jsx)("div",{className:"text-4xl mb-4",children:"\uD83D\uDD0D"}),(0,l.jsx)("p",{className:(0,i.cn)("text-lg font-medium",o?"text-neutral-300":"text-neutral-700"),children:(0,d.t)("no_goods_match",$)}),(0,l.jsx)("p",{className:(0,i.cn)("text-sm mt-2",o?"text-neutral-400":"text-neutral-600"),children:(0,d.t)("try_widen_radius",$)})]}),(0,l.jsx)("div",{ref:H,className:"pt-4",children:(0,l.jsx)("div",{className:(0,i.cn)("text-center text-sm",o?"text-neutral-400":"text-neutral-600"),children:z?(0,d.t)("loading_more",$):B?"":(0,d.t)("no_more_results",$)})})]})]})]}),U&&(0,l.jsx)(r.F8,{open:U,onClose:()=>P(!1),initialCenter:{lat:D.lat,lng:D.lng,name:D.name},initialRadiusKm:E,dark:o,onApply:(e,t)=>{F(e),R(t);try{localStorage.setItem("userLocation",JSON.stringify(e)),localStorage.setItem("userRadiusKm",String(t))}catch(e){}P(!1)}}),f&&(0,l.jsx)(r.dw,{listing:f,onClose:()=>b(null),unit:t,btcCad:K,dark:o,onChat:()=>ee(()=>v(f))}),w&&(0,l.jsx)(r.Im,{listing:w,onClose:()=>v(null),dark:o,btcCad:K,unit:t}),N&&(0,l.jsx)(r.Vs,{dark:o,onClose:()=>y(!1),onPublish:e=>{x(t=>[{...e,id:"l".concat(t.length+1)},...t]),y(!1)}}),j&&(0,l.jsx)(r.Qb,{dark:o,onClose:()=>S(!1),onAuthed:e=>{p(e),S(!1)}})]})}}},function(e){e.O(0,[868,349,248,464,971,526,744],function(){return e(e.s=2769)}),_N_E=e.O()}]);